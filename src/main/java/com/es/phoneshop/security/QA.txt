я могу предложить несколько стратегий по учёту/фильтрации
входные данные
    промежуток между запросами -- 1 минута = t
    max запросов: 100 на это время = r
1. если превышает r запросов, то не обрабатываем запрос
    очищаем каждые t
    плюсы :
        просто реализовать
        не так требовательно на процессор
        заполняемость памяти меньше
    минусы :
        можно добиться того, что
        за определенное время до конца очистки сделать r запросов
        а потом сделать сразу ещё r
        и можно получить 2r запросов за меньше t
        но я Предполагаю, что это можно отрегулировать здравым подбором t и r

2. каждый раз проверять ip, каждый раз проверять сколько времени прошло
    регулярно проверять "устаревшие сессии"
        можно добиться решения минуса для 1., но ценой памяти И производительности

тк нам важна "цена-качество" для время отклика, памяти и эффективности решения проблемы
то я выбираю 1.

из особенностей
    предполагается, что DefaultDosPS используется только в одном месте/фильтре
    это к тому, что -- он решает, когда нужно shutdown выполнить